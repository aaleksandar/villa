# Development Dockerfile for Villa Monorepo

FROM oven/bun:1-alpine

WORKDIR /app

# Install dependencies for native modules
RUN apk add --no-cache libc6-compat python3 make g++ nodejs npm

# Copy package files for all workspaces
COPY package.json bun.lock ./
COPY apps/hub/package.json ./apps/hub/
COPY packages/sdk/package.json ./packages/sdk/
COPY packages/ui/package.json ./packages/ui/
COPY packages/config/package.json ./packages/config/

# Install all dependencies (including devDependencies)
RUN bun install --frozen-lockfile

# Copy source code
COPY . .

# Build environment
ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1

EXPOSE 3000

# Start dev server
WORKDIR /app/apps/hub
CMD ["bun", "dev"]
